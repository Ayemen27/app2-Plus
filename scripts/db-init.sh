#!/bin/bash

# Script ูุชููุฆุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช - ูุน ุงูุชุนุงูู ูุน ุงูุฃูุงูุฑ ุงูุชูุงุนููุฉ

echo "๐ง ุจุฏุก ุชููุฆุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช..."
echo "================================"

# ูุญุงููุฉ ุชุดุบูู db:push ูุน ุงูุฅุฌุงุจุฉ ุงูุชููุงุฆูุฉ ุนูู ุงูุฃุณุฆูุฉ
(
  sleep 2
  echo "y"
  sleep 1
  echo "yes"
  sleep 1
  echo "Y"
) | npm run db:push 2>&1

DB_PUSH_EXIT=$?

if [ $DB_PUSH_EXIT -eq 0 ]; then
  echo ""
  echo "โ ุชู ุชููุฆุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจูุฌุงุญ!"
  exit 0
else
  echo ""
  echo "โ๏ธ ูุญุงููุฉ ุฃุฎุฑู ูุน --force flag..."
  npm run db:push -- --force 2>&1
  
  if [ $? -eq 0 ]; then
    echo "โ ุชู ุชููุฆุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุจูุฌุงุญ!"
    exit 0
  else
    echo "โ ูุดู ุชููุฆุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช"
    exit 1
  fi
fi
